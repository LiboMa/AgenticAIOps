{
  "incident_id": "inc-eb06052ae3ef",
  "trigger_type": "anomaly",
  "trigger_data": {
    "source": "detect_agent",
    "detect_id": "det-6182a9d1c9b2"
  },
  "region": "ap-southeast-1",
  "status": "completed",
  "collection_summary": {
    "collection_id": "a2b720a6fd86",
    "metrics": 0,
    "alarms": 1,
    "trail_events": 0,
    "anomalies": 0,
    "health_events": 10,
    "duration_ms": 1437,
    "source": "detect_agent_reuse",
    "detect_id": "det-6182a9d1c9b2",
    "data_age_seconds": 1.4
  },
  "rca_result": {
    "pattern_id": "llm-sonnet-config",
    "pattern_name": "Claude Sonnet Analysis",
    "root_cause": "Multiple AWS service health events indicate potential infrastructure vulnerabilities and service disruptions, primarily Auto Scaling launch template misconfiguration and VPN redundancy loss affecting network connectivity",
    "severity": "medium",
    "confidence": 0.75,
    "matched_symptoms": [
      "autoscaling-launch-templates",
      "vpn-connections",
      "kafka-clusters",
      "lambda-functions"
    ],
    "evidence": [
      "AWS_EC2_AUTOSCALING_LAUNCH_TEMPLATE_NOT_FOUND indicates missing or deleted launch template preventing Auto Scaling operations",
      "Multiple AWS_VPN_REDUNDANCY_LOSS events suggest VPN tunnel failures reducing network redundancy",
      "AWS_KAFKA_HIGH_RISK_CONFIG_RF_EQUALS_ONE indicates Kafka replication factor of 1, creating single point of failure",
      "Multiple AWS_LAMBDA_PLANNED_LIFECYCLE_EVENT notifications indicate upcoming Lambda runtime changes",
      "Pattern match with historical case (score: 0.59) showing similar multi-service health event scenario"
    ],
    "timestamp": "2026-02-13T13:48:43.867005+00:00",
    "remediation": {
      "action": "multi_service_health_remediation",
      "auto_execute": false,
      "params": {},
      "suggestion": "Address critical Auto Scaling and VPN issues while preparing for Lambda lifecycle changes",
      "checklist": [
        "Verify Auto Scaling launch template exists and recreate if missing",
        "Check VPN tunnel status and restart failed tunnels",
        "Review Kafka cluster configuration and increase replication factor if possible",
        "Prepare for Lambda runtime updates by testing functions with new runtimes",
        "Monitor all affected services for 24 hours post-remediation"
      ]
    }
  },
  "matched_sops": [
    {
      "sop_id": "sop-ec2-unreachable",
      "name": "EC2 Instance Unreachable Response",
      "description": "Handle EC2 instances failing status checks",
      "service": "ec2",
      "severity": "high",
      "steps": 5,
      "est_minutes": 18,
      "match_type": "pattern_match",
      "match_confidence": 0.9,
      "auto_execute": false,
      "risk_level": "L2"
    }
  ],
  "safety_check": {
    "passed": true,
    "risk_level": "L2",
    "execution_mode": "dry_run",
    "reason": "Dry-run \u6a21\u5f0f: \u9884\u89c8 sop-ec2-unreachable \u5bf9 4 \u4e2a\u8d44\u6e90\u7684\u64cd\u4f5c",
    "cooldown_remaining_seconds": 0,
    "warnings": [],
    "required_approvers": [],
    "dry_run_preview": {
      "sop_id": "sop-ec2-unreachable",
      "risk_level": "L2",
      "target_resources": [
        "autoscaling-launch-templates",
        "vpn-connections",
        "kafka-clusters",
        "lambda-functions"
      ],
      "execution_mode": "confirm",
      "cooldown_after": "0:30:00",
      "daily_limit": 5,
      "current_daily_count": 0,
      "preview_note": "This is a dry-run. No changes will be made."
    }
  },
  "execution_result": null,
  "created_at": "2026-02-13T13:48:34.819579+00:00",
  "completed_at": "2026-02-13T13:48:43.867347+00:00",
  "duration_ms": 9047,
  "stage_timings": {
    "collect": 0,
    "analyze": 9047,
    "sop_match": 0,
    "safety_check": 0
  },
  "error": null
}