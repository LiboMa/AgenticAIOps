import{A as b,Y as te,e as B,E as _,G as ne,K as U,_ as z,W as fe,Z as ve,t as ae,n as ge,ai as xe,X as pe,s as ye,r as C,C as he,g as be,m as Ce,u as M,aj as $e,a as Ie,a5 as Se,ak as je,l as we,b as Pe,al as Ne,p as q,am as Re,v as Y,I as ie,z as a,S as Z,an as V,B as Ae,L as J}from"./index-or2Et6SO.js";import{p as Ee,d as ke,C as T,h as se,E as Me}from"./index-06NOBGRW.js";import{R as Oe}from"./ReloadOutlined-BhLEVFKR.js";import{R as _e,C as D,F as ze,a as Be}from"./Table-sLRq_9IJ.js";import{S as G,R as Ke,a as Te}from"./ExclamationCircleOutlined-VLqKgheo.js";import{R as oe,a as Le,b as He}from"./LockOutlined-DLLKnu1b.js";var le=b.forwardRef(function(t,e){var n=t.prefixCls,i=t.forceRender,d=t.className,m=t.style,f=t.children,c=t.isActive,v=t.role,u=t.classNames,l=t.styles,r=b.useState(c||i),g=te(r,2),s=g[0],x=g[1];return b.useEffect(function(){(i||c)&&x(!0)},[i,c]),s?b.createElement("div",{ref:e,className:B("".concat(n,"-content"),_(_({},"".concat(n,"-content-active"),c),"".concat(n,"-content-inactive"),!c),d),style:m,role:v},b.createElement("div",{className:B("".concat(n,"-content-box"),u?.body),style:l?.body},f)):null});le.displayName="PanelContent";var De=["showArrow","headerClass","isActive","onItemClick","forceRender","className","classNames","styles","prefixCls","collapsible","accordion","panelKey","extra","header","expandIcon","openMotion","destroyInactivePanel","children"],re=b.forwardRef(function(t,e){var n=t.showArrow,i=n===void 0?!0:n,d=t.headerClass,m=t.isActive,f=t.onItemClick,c=t.forceRender,v=t.className,u=t.classNames,l=u===void 0?{}:u,r=t.styles,g=r===void 0?{}:r,s=t.prefixCls,x=t.collapsible,y=t.accordion,I=t.panelKey,p=t.extra,h=t.header,$=t.expandIcon,o=t.openMotion,w=t.destroyInactivePanel,S=t.children,R=ne(t,De),j=x==="disabled",P=p!=null&&typeof p!="boolean",N=_(_(_({onClick:function(){f?.(I)},onKeyDown:function(k){(k.key==="Enter"||k.keyCode===U.ENTER||k.which===U.ENTER)&&f?.(I)},role:y?"tab":"button"},"aria-expanded",m),"aria-disabled",j),"tabIndex",j?-1:0),O=typeof $=="function"?$(t):b.createElement("i",{className:"arrow"}),L=O&&b.createElement("div",z({className:"".concat(s,"-expand-icon")},["header","icon"].includes(x)?N:{}),O),F=B("".concat(s,"-item"),_(_({},"".concat(s,"-item-active"),m),"".concat(s,"-item-disabled"),j),v),W=B(d,"".concat(s,"-header"),_({},"".concat(s,"-collapsible-").concat(x),!!x),l.header),A=fe({className:W,style:g.header},["header","icon"].includes(x)?{}:N);return b.createElement("div",z({},R,{ref:e,className:F}),b.createElement("div",A,i&&L,b.createElement("span",z({className:"".concat(s,"-header-text")},x==="header"?N:{}),h),P&&b.createElement("div",{className:"".concat(s,"-extra")},p)),b.createElement(ve,z({visible:m,leavedClassName:"".concat(s,"-content-hidden")},o,{forceRender:c,removeOnLeave:w}),function(E,k){var H=E.className,K=E.style;return b.createElement(le,{ref:k,prefixCls:s,className:H,classNames:l,style:K,styles:g,isActive:m,forceRender:c,role:y?"tabpanel":void 0},S)}))}),Ge=["children","label","key","collapsible","onItemClick","destroyInactivePanel"],Fe=function(e,n){var i=n.prefixCls,d=n.accordion,m=n.collapsible,f=n.destroyInactivePanel,c=n.onItemClick,v=n.activeKey,u=n.openMotion,l=n.expandIcon;return e.map(function(r,g){var s=r.children,x=r.label,y=r.key,I=r.collapsible,p=r.onItemClick,h=r.destroyInactivePanel,$=ne(r,Ge),o=String(y??g),w=I??m,S=h??f,R=function(N){w!=="disabled"&&(c(N),p?.(N))},j=!1;return d?j=v[0]===o:j=v.indexOf(o)>-1,b.createElement(re,z({},$,{prefixCls:i,key:o,panelKey:o,isActive:j,accordion:d,openMotion:u,expandIcon:l,header:x,collapsible:w,onItemClick:R,destroyInactivePanel:S}),s)})},We=function(e,n,i){if(!e)return null;var d=i.prefixCls,m=i.accordion,f=i.collapsible,c=i.destroyInactivePanel,v=i.onItemClick,u=i.activeKey,l=i.openMotion,r=i.expandIcon,g=e.key||String(n),s=e.props,x=s.header,y=s.headerClass,I=s.destroyInactivePanel,p=s.collapsible,h=s.onItemClick,$=!1;m?$=u[0]===g:$=u.indexOf(g)>-1;var o=p??f,w=function(j){o!=="disabled"&&(v(j),h?.(j))},S={key:g,panelKey:g,header:x,headerClass:y,isActive:$,prefixCls:d,destroyInactivePanel:I??c,openMotion:l,accordion:m,children:e.props.children,onItemClick:w,expandIcon:r,collapsible:o};return typeof e.type=="string"?e:(Object.keys(S).forEach(function(R){typeof S[R]>"u"&&delete S[R]}),b.cloneElement(e,S))};function Ve(t,e,n){return Array.isArray(t)?Fe(t,n):ae(e).map(function(i,d){return We(i,d,n)})}function Xe(t){var e=t;if(!Array.isArray(e)){var n=pe(e);e=n==="number"||n==="string"?[e]:[]}return e.map(function(i){return String(i)})}var Ue=b.forwardRef(function(t,e){var n=t.prefixCls,i=n===void 0?"rc-collapse":n,d=t.destroyInactivePanel,m=d===void 0?!1:d,f=t.style,c=t.accordion,v=t.className,u=t.children,l=t.collapsible,r=t.openMotion,g=t.expandIcon,s=t.activeKey,x=t.defaultActiveKey,y=t.onChange,I=t.items,p=B(i,v),h=ge([],{value:s,onChange:function(P){return y?.(P)},defaultValue:x,postState:Xe}),$=te(h,2),o=$[0],w=$[1],S=function(P){return w(function(){if(c)return o[0]===P?[]:[P];var N=o.indexOf(P),O=N>-1;return O?o.filter(function(L){return L!==P}):[].concat(ye(o),[P])})};xe(!u,"[rc-collapse] `children` will be removed in next major version. Please use `items` instead.");var R=Ve(I,u,{prefixCls:i,accordion:c,openMotion:r,expandIcon:g,collapsible:l,destroyInactivePanel:m,onItemClick:S,activeKey:o});return b.createElement("div",z({ref:e,className:p,style:f,role:c?"tablist":void 0},Ee(t,{aria:!0,data:!0})),R)});const X=Object.assign(Ue,{Panel:re});X.Panel;const qe=C.forwardRef((t,e)=>{const{getPrefixCls:n}=C.useContext(he),{prefixCls:i,className:d,showArrow:m=!0}=t,f=n("collapse",i),c=B({[`${f}-no-arrow`]:!m},d);return C.createElement(X.Panel,Object.assign({ref:e},t,{prefixCls:f,className:c}))}),Ye=t=>{const{componentCls:e,contentBg:n,padding:i,headerBg:d,headerPadding:m,collapseHeaderPaddingSM:f,collapseHeaderPaddingLG:c,collapsePanelBorderRadius:v,lineWidth:u,lineType:l,colorBorder:r,colorText:g,colorTextHeading:s,colorTextDisabled:x,fontSizeLG:y,lineHeight:I,lineHeightLG:p,marginSM:h,paddingSM:$,paddingLG:o,paddingXS:w,motionDurationSlow:S,fontSizeIcon:R,contentPadding:j,fontHeight:P,fontHeightLG:N}=t,O=`${M(u)} ${l} ${r}`;return{[e]:Object.assign(Object.assign({},Ie(t)),{backgroundColor:d,border:O,borderRadius:v,"&-rtl":{direction:"rtl"},[`& > ${e}-item`]:{borderBottom:O,"&:first-child":{[`
            &,
            & > ${e}-header`]:{borderRadius:`${M(v)} ${M(v)} 0 0`}},"&:last-child":{[`
            &,
            & > ${e}-header`]:{borderRadius:`0 0 ${M(v)} ${M(v)}`}},[`> ${e}-header`]:Object.assign(Object.assign({position:"relative",display:"flex",flexWrap:"nowrap",alignItems:"flex-start",padding:m,color:s,lineHeight:I,cursor:"pointer",transition:`all ${S}, visibility 0s`},Se(t)),{[`> ${e}-header-text`]:{flex:"auto"},[`${e}-expand-icon`]:{height:P,display:"flex",alignItems:"center",paddingInlineEnd:h},[`${e}-arrow`]:Object.assign(Object.assign({},je()),{fontSize:R,transition:`transform ${S}`,svg:{transition:`transform ${S}`}}),[`${e}-header-text`]:{marginInlineEnd:"auto"}}),[`${e}-collapsible-header`]:{cursor:"default",[`${e}-header-text`]:{flex:"none",cursor:"pointer"},[`${e}-expand-icon`]:{cursor:"pointer"}},[`${e}-collapsible-icon`]:{cursor:"unset",[`${e}-expand-icon`]:{cursor:"pointer"}}},[`${e}-content`]:{color:g,backgroundColor:n,borderTop:O,[`& > ${e}-content-box`]:{padding:j},"&-hidden":{display:"none"}},"&-small":{[`> ${e}-item`]:{[`> ${e}-header`]:{padding:f,paddingInlineStart:w,[`> ${e}-expand-icon`]:{marginInlineStart:t.calc($).sub(w).equal()}},[`> ${e}-content > ${e}-content-box`]:{padding:$}}},"&-large":{[`> ${e}-item`]:{fontSize:y,lineHeight:p,[`> ${e}-header`]:{padding:c,paddingInlineStart:i,[`> ${e}-expand-icon`]:{height:N,marginInlineStart:t.calc(o).sub(i).equal()}},[`> ${e}-content > ${e}-content-box`]:{padding:o}}},[`${e}-item:last-child`]:{borderBottom:0,[`> ${e}-content`]:{borderRadius:`0 0 ${M(v)} ${M(v)}`}},[`& ${e}-item-disabled > ${e}-header`]:{"\n          &,\n          & > .arrow\n        ":{color:x,cursor:"not-allowed"}},[`&${e}-icon-position-end`]:{[`& > ${e}-item`]:{[`> ${e}-header`]:{[`${e}-expand-icon`]:{order:1,paddingInlineEnd:0,paddingInlineStart:h}}}}})}},Ze=t=>{const{componentCls:e}=t,n=`> ${e}-item > ${e}-header ${e}-arrow`;return{[`${e}-rtl`]:{[n]:{transform:"rotate(180deg)"}}}},Je=t=>{const{componentCls:e,headerBg:n,borderlessContentPadding:i,borderlessContentBg:d,colorBorder:m}=t;return{[`${e}-borderless`]:{backgroundColor:n,border:0,[`> ${e}-item`]:{borderBottom:`1px solid ${m}`},[`
        > ${e}-item:last-child,
        > ${e}-item:last-child ${e}-header
      `]:{borderRadius:0},[`> ${e}-item:last-child`]:{borderBottom:0},[`> ${e}-item > ${e}-content`]:{backgroundColor:d,borderTop:0},[`> ${e}-item > ${e}-content > ${e}-content-box`]:{padding:i}}}},Qe=t=>{const{componentCls:e,paddingSM:n}=t;return{[`${e}-ghost`]:{backgroundColor:"transparent",border:0,[`> ${e}-item`]:{borderBottom:0,[`> ${e}-content`]:{backgroundColor:"transparent",border:0,[`> ${e}-content-box`]:{paddingBlock:n}}}}}},et=t=>({headerPadding:`${t.paddingSM}px ${t.padding}px`,headerBg:t.colorFillAlter,contentPadding:`${t.padding}px 16px`,contentBg:t.colorBgContainer,borderlessContentPadding:`${t.paddingXXS}px 16px ${t.padding}px`,borderlessContentBg:"transparent"}),tt=be("Collapse",t=>{const e=Ce(t,{collapseHeaderPaddingSM:`${M(t.paddingXS)} ${M(t.paddingSM)}`,collapseHeaderPaddingLG:`${M(t.padding)} ${M(t.paddingLG)}`,collapsePanelBorderRadius:t.borderRadiusLG});return[Ye(e),Je(e),Qe(e),Ze(e),$e(e)]},et),nt=C.forwardRef((t,e)=>{const{getPrefixCls:n,direction:i,expandIcon:d,className:m,style:f}=we("collapse"),{prefixCls:c,className:v,rootClassName:u,style:l,bordered:r=!0,ghost:g,size:s,expandIconPosition:x="start",children:y,destroyInactivePanel:I,destroyOnHidden:p,expandIcon:h}=t,$=Pe(A=>{var E;return(E=s??A)!==null&&E!==void 0?E:"middle"}),o=n("collapse",c),w=n(),[S,R,j]=tt(o),P=C.useMemo(()=>x==="left"?"start":x==="right"?"end":x,[x]),N=h??d,O=C.useCallback((A={})=>{const E=typeof N=="function"?N(A):C.createElement(Ne,{rotate:A.isActive?i==="rtl"?-90:90:void 0,"aria-label":A.isActive?"expanded":"collapsed"});return q(E,()=>{var k;return{className:B((k=E.props)===null||k===void 0?void 0:k.className,`${o}-arrow`)}})},[N,o,i]),L=B(`${o}-icon-position-${P}`,{[`${o}-borderless`]:!r,[`${o}-rtl`]:i==="rtl",[`${o}-ghost`]:!!g,[`${o}-${$}`]:$!=="middle"},m,v,u,R,j),F=C.useMemo(()=>Object.assign(Object.assign({},Re(w)),{motionAppear:!1,leavedClassName:`${o}-content-hidden`}),[w,o]),W=C.useMemo(()=>y?ae(y).map((A,E)=>{var k,H;const K=A.props;if(K?.disabled){const ue=(k=A.key)!==null&&k!==void 0?k:String(E),me=Object.assign(Object.assign({},Y(A.props,["disabled"])),{key:ue,collapsible:(H=K.collapsible)!==null&&H!==void 0?H:"disabled"});return q(A,me)}return A}):null,[y]);return S(C.createElement(X,Object.assign({ref:e,openMotion:F},Y(t,["rootClassName"]),{expandIcon:O,prefixCls:o,className:L,style:Object.assign(Object.assign({},f),l),destroyInactivePanel:p??I}),W))}),ce=Object.assign(nt,{Panel:qe});var at={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917.7 148.8l-42.4-42.4c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-76.1 76.1a199.27 199.27 0 00-112.1-34.3c-51.2 0-102.4 19.5-141.5 58.6L432.3 308.7a8.03 8.03 0 000 11.3L704 591.7c1.6 1.6 3.6 2.3 5.7 2.3 2 0 4.1-.8 5.7-2.3l101.9-101.9c68.9-69 77-175.7 24.3-253.5l76.1-76.1c3.1-3.2 3.1-8.3 0-11.4zM769.1 441.7l-59.4 59.4-186.8-186.8 59.4-59.4c24.9-24.9 58.1-38.7 93.4-38.7 35.3 0 68.4 13.7 93.4 38.7 24.9 24.9 38.7 58.1 38.7 93.4 0 35.3-13.8 68.4-38.7 93.4zm-190.2 105a8.03 8.03 0 00-11.3 0L501 613.3 410.7 523l66.7-66.7c3.1-3.1 3.1-8.2 0-11.3L441 408.6a8.03 8.03 0 00-11.3 0L363 475.3l-43-43a7.85 7.85 0 00-5.7-2.3c-2 0-4.1.8-5.7 2.3L206.8 534.2c-68.9 69-77 175.7-24.3 253.5l-76.1 76.1a8.03 8.03 0 000 11.3l42.4 42.4c1.6 1.6 3.6 2.3 5.7 2.3s4.1-.8 5.7-2.3l76.1-76.1c33.7 22.9 72.9 34.3 112.1 34.3 51.2 0 102.4-19.5 141.5-58.6l101.9-101.9c3.1-3.1 3.1-8.2 0-11.3l-43-43 66.7-66.7c3.1-3.1 3.1-8.2 0-11.3l-36.6-36.2zM441.7 769.1a131.32 131.32 0 01-93.4 38.7c-35.3 0-68.4-13.7-93.4-38.7a131.32 131.32 0 01-38.7-93.4c0-35.3 13.7-68.4 38.7-93.4l59.4-59.4 186.8 186.8-59.4 59.4z"}}]},name:"api",theme:"outlined"},it=function(e,n){return C.createElement(ie,z({},e,{ref:n,icon:at}))},st=C.forwardRef(it),ot={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},lt=function(e,n){return C.createElement(ie,z({},e,{ref:n,icon:ot}))},de=C.forwardRef(lt);const{Title:rt,Text:Q}=ke,{Panel:ct}=ce,dt={ec2:a.jsx(oe,{}),lambda:a.jsx(st,{}),s3:a.jsx(Be,{}),rds:a.jsx(He,{}),iam:a.jsx(Le,{}),security_hub:a.jsx(V,{}),guardduty:a.jsx(de,{})},ee={summary:{total:12,critical:2,high:3,medium:5,low:2},by_service:{iam:{name:"IAM",icon:"iam",findings:[{id:1,title:"Root account MFA not enabled",severity:"critical",status:"open"},{id:2,title:"Access keys older than 90 days",severity:"high",status:"open"},{id:3,title:"Unused IAM credentials",severity:"medium",status:"open"}]},s3:{name:"S3",icon:"s3",findings:[{id:4,title:"Public bucket detected: static-website-bucket",severity:"high",status:"open"},{id:5,title:"Bucket without encryption: backup-bucket",severity:"medium",status:"open"},{id:6,title:"No bucket versioning: logs-bucket",severity:"low",status:"open"}]},ec2:{name:"EC2",icon:"ec2",findings:[{id:7,title:"Security group allows 0.0.0.0/0 on port 22",severity:"critical",status:"open"},{id:8,title:"Instance without IMDSv2",severity:"medium",status:"open"}]},rds:{name:"RDS",icon:"rds",findings:[{id:9,title:"Public accessibility enabled",severity:"high",status:"open"},{id:10,title:"Encryption at rest disabled",severity:"medium",status:"open"}]},lambda:{name:"Lambda",icon:"lambda",findings:[{id:11,title:"Function using deprecated runtime",severity:"low",status:"open"},{id:12,title:"Overly permissive execution role",severity:"medium",status:"open"}]}}},ut=({severity:t})=>{const e={critical:{color:"#cf1322",text:"CRITICAL"},high:{color:"#ff4d4f",text:"HIGH"},medium:{color:"#faad14",text:"MEDIUM"},low:{color:"#52c41a",text:"LOW"}},n=e[t]||e.low;return a.jsx(se,{color:n.color,children:n.text})};function yt({apiUrl:t}){const[e,n]=C.useState(ee),[i,d]=C.useState(!1),[m,f]=C.useState(["iam","s3"]),c=async()=>{d(!0);try{await new Promise(l=>setTimeout(l,500)),n(ee)}catch(l){console.error("Failed to fetch security data:",l)}finally{d(!1)}};C.useEffect(()=>{c()},[]);const v=[{title:"Finding",dataIndex:"title",key:"title",render:l=>a.jsx(Q,{children:l})},{title:"Severity",dataIndex:"severity",key:"severity",width:120,render:l=>a.jsx(ut,{severity:l})},{title:"Status",dataIndex:"status",key:"status",width:100,render:l=>a.jsx(J,{status:l==="open"?"error":"success",text:l==="open"?"Open":"Resolved"})}],u=e.summary;return a.jsxs("div",{style:{padding:24},children:[a.jsxs("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs(Z,{children:[a.jsx(V,{style:{fontSize:24,color:"#06AC38"}}),a.jsx(rt,{level:3,style:{margin:0},children:"Security Dashboard"})]}),a.jsx(Ae,{icon:a.jsx(Oe,{}),onClick:c,loading:i,children:"Refresh"})]}),a.jsxs(_e,{gutter:16,style:{marginBottom:24},children:[a.jsx(D,{span:4,children:a.jsx(T,{size:"small",children:a.jsx(G,{title:"Total Findings",value:u.total,prefix:a.jsx(V,{})})})}),a.jsx(D,{span:5,children:a.jsx(T,{size:"small",children:a.jsx(G,{title:"Critical",value:u.critical,valueStyle:{color:"#cf1322"},prefix:a.jsx(Ke,{})})})}),a.jsx(D,{span:5,children:a.jsx(T,{size:"small",children:a.jsx(G,{title:"High",value:u.high,valueStyle:{color:"#ff4d4f"},prefix:a.jsx(de,{})})})}),a.jsx(D,{span:5,children:a.jsx(T,{size:"small",children:a.jsx(G,{title:"Medium",value:u.medium,valueStyle:{color:"#faad14"}})})}),a.jsx(D,{span:5,children:a.jsx(T,{size:"small",children:a.jsx(G,{title:"Low",value:u.low,valueStyle:{color:"#52c41a"},prefix:a.jsx(Te,{})})})})]}),a.jsxs(T,{title:"Security Findings by AWS Service",loading:i,children:[a.jsx(ce,{activeKey:m,onChange:f,children:Object.entries(e.by_service).map(([l,r])=>{const g=r.findings.filter(s=>s.severity==="critical"||s.severity==="high").length;return a.jsx(ct,{header:a.jsxs(Z,{children:[dt[r.icon]||a.jsx(oe,{}),a.jsx(Q,{strong:!0,children:r.name}),a.jsx(J,{count:r.findings.length,style:{backgroundColor:g>0?"#ff4d4f":"#52c41a"}}),g>0&&a.jsxs(se,{color:"red",children:[g," Critical/High"]})]}),children:a.jsx(ze,{columns:v,dataSource:r.findings,rowKey:"id",pagination:!1,size:"small"})},l)})}),Object.keys(e.by_service).length===0&&a.jsx(Me,{description:"No security findings"})]})]})}export{yt as default};
